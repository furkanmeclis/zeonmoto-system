import{j as t,r as l,S as Q,F as p}from"./app-Pig5I6s_.js";import{A as $}from"./AuthenticatedLayout-D9TlC9Hs.js";import{T as J}from"./toolbar.esm-Dmg3GOJs.js";import{B as h}from"./button.esm-DlrAX-hR.js";import{D as q,C as d}from"./column.esm-bJFYJjtz.js";import{C as W,c as Z}from"./confirmpopup.esm-C_eZ4QQh.js";import{T as ee}from"./toast.esm-jwsTFuMN.js";import{D as O}from"./dropdown.esm-CC9i8FCO.js";import{I as z}from"./inputswitch.esm-B7z1MU3y.js";import te from"./Images-DU_yv6iZ.js";import re from"./Categories-BMXZk7p3.js";import ae from"./Create-DJtaYaon.js";import ie from"./Update-S7Xv4olH.js";import{D as se}from"./dialog.esm-DNUkyrbB.js";import"./html2canvas.esm-BfYXEYrK.js";import{I as A}from"./inputtext.esm-Dw5DaSkR.js";import{D as le}from"./divider.esm-CCR2LgGy.js";import{I as ne}from"./inputnumber.esm-D4Q-i1QM.js";import{b as R}from"./helper-CgTmtTxK.js";import{C as v}from"./checkbox.esm-Cwh5GPki.js";import"./ApplicationLogo-DrcfPo1c.js";import"./transition-BtivIp9i.js";import"./tooltip.esm-CPsCiA7s.js";import"./index.esm-BA-WXsC_.js";import"./index.esm-Dq8gwrk2.js";import"./index.esm-CXUAPdpC.js";import"./index.esm-TXDjSa-F.js";import"./overlayservice.esm-BGTfZ6dC.js";import"./index.esm-BNURNYvu.js";import"./image.esm-BxSLV4Tf.js";import"./progressbar.esm-Shy7697Y.js";import"./formik.esm-tXizl-mo.js";const oe=()=>t.jsx(t.Fragment,{}),Be=({auth:C,csrf_token:o,categories:y})=>{const[f,m]=l.useState([]),[H,K]=l.useState(!1);l.useState(!1);const a=l.useRef(null),[g,u]=l.useState(!0),[j,S]=l.useState(null),[L,k]=l.useState(!1),[M,P]=l.useState(!1),[I,b]=l.useState(!1),[w,V]=l.useState(y),[D,E]=l.useState(!1),[B,F]=l.useState(!1),[Y,ue]=l.useState(!1),[N,U]=l.useState(!0),[T,G]=l.useState(!0),[_,X]=l.useState(!0);l.useEffect(()=>{R(o).then(e=>{e.status?m(e.data):a.current.show({severity:"error",summary:"Hata",detail:"Ürünler yüklenirken bir hata oluştu."})}).catch(e=>{console.log(e),a.current.show({severity:"error",summary:"Hata",detail:"Ürünler yüklenirken bir hata oluştu."})}).finally(()=>u(!1))},[]);const x=({rowData:e,field:r,newValue:s})=>{if(e[r]===s){a.current.show({severity:"info",summary:"Uyarı",detail:"Değişiklik Olmadı"});return}let i=e.id;e={...e,[r]:s},u(!0);let n=new FormData;n.append("sku",e.sku),n.append("name",e.name),n.append("category",e.category),n.append("price",e.price),n.append("is_new",e.is_new?1:0),n.append("is_discount",e.is_discount?1:0),n.append("is_active",e.is_active?1:0),n.append("order",e.order),n.append("_method","PUT"),fetch(route("products.update",i),{method:"POST",headers:{"X-CSRF-TOKEN":o},body:n}).then(c=>c.json()).then(c=>{c.status?(a.current.show({severity:"success",summary:"Başarılı",detail:c.message}),m(c.products)):a.current.show({severity:"error",summary:"Hata",detail:c.message})}).catch(c=>{a.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{u(!1)})};return t.jsx(t.Fragment,{children:t.jsxs($,{user:C.user,header:"Ürünler",info:[{icon:"pi-box",text:`${f.length} adet ürün bulunmaktadır.`},{icon:"pi-check",text:`${f.map(e=>e.is_active===1?!0:null).filter(Boolean).length} adet aktif ürün bulunmaktadır.`},{icon:"pi-times",text:`${f.map(e=>e.is_active===0?!0:null).filter(Boolean).length} adet pasif ürün bulunmaktadır.`}],buttons:[{icon:"pi pi-plus",tooltip:"Yeni Ürün Ekle",severity:"success",tooltipOptions:{position:"bottom"},size:"small",onClick:()=>{E(!0)}}],children:[t.jsx(ee,{ref:a}),t.jsx(Q,{title:"Ürünler"}),t.jsx(W,{}),t.jsx("div",{className:"py-6",children:t.jsx("div",{className:"max-w-[90rem] mx-auto sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:t.jsxs(q,{value:f,removableSort:!0,paginator:!0,stripedRows:!0,editMode:"cell",reorderableRows:!0,onRowReorder:e=>{let r=e.value.map(({id:i},n)=>({id:i,sort:n+1}));m(e.value);let s=new FormData;s.append("data",JSON.stringify(r)),u(!0),fetch(route("products.updateOrder"),{method:"POST",headers:{"X-CSRF-TOKEN":o},body:s}).then(i=>i.json()).then(i=>{i.status?(a.current.show({severity:"success",summary:"Başarılı",detail:i.message}),m(i.products)):a.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{a.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{u(!1)})},filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",filters:{name:{value:null,matchMode:p.CONTAINS},sku:{value:null,matchMode:p.CONTAINS},category:{value:null,matchMode:p.EQUALS},price:{value:null,matchMode:p.CONTAINS},is_active:{value:null,matchMode:p.EQUALS},source:{value:null,matchMode:p.EQUALS},calculated_price:{value:null,matchMode:p.CONTAINS}},loading:g,header:t.jsx(t.Fragment,{children:t.jsx(J,{start:()=>t.jsx(t.Fragment,{children:t.jsx(h,{icon:"pi pi-arrow-right-arrow-left",severity:"success",tooltip:"Bu Ekrandan Kategorileri Yönetebilirsiniz.",tooltipOptions:{position:"top"},label:"Ürün Eşitle",onClick:()=>{b(!0)}})}),end:()=>t.jsx(t.Fragment,{children:t.jsx(h,{icon:"pi pi-bars",severity:"info",tooltip:"Bu Ekrandan Kategorileri Yönetebilirsiniz.",tooltipOptions:{position:"top"},label:"Kategoriler",onClick:()=>{P(!0)}})})})}),emptyMessage:"Ürün bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",children:[t.jsx(d,{rowReorder:!0,style:{width:"3rem"}}),t.jsx(d,{field:"order",sortable:!0,header:"#"}),t.jsx(d,{field:"is_active",style:{width:"3rem"},header:"Aktif",body:e=>t.jsx(z,{checked:!!e.is_active,onChange:({value:r})=>{u(!0);let s=new FormData;s.append("is_active",r===!0?1:0),fetch(route("products.updateIsActive",e.id),{method:"POST",headers:{"X-CSRF-TOKEN":o},body:s}).then(i=>i.json()).then(i=>{i.status?(a.current.show({severity:"success",summary:"Başarılı",detail:i.message}),m(n=>n.map(c=>(c.id===e.id&&(c.is_active=r===!0?1:0),c)))):a.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{a.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{u(!1)})}}),filter:!0,showFilterMenu:!1,filterElement:e=>t.jsx(z,{checked:e.value===1,onChange:({value:r})=>{e.filterApplyCallback(r===!0?1:0)}})}),t.jsx(d,{field:"sku",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Koduna Göre",onCellEditComplete:e=>x(e),editor:e=>t.jsx(A,{type:"text",value:e.value,onChange:r=>e.editorCallback(r.target.value),onKeyDown:r=>r.stopPropagation()}),sortable:!0,header:"Ürün Kodu"}),t.jsx(d,{field:"name",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Adına Göre",sortable:!0,header:"Ürün Adı",onCellEditComplete:e=>x(e),editor:e=>t.jsx(A,{type:"text",value:e.value,onChange:r=>e.editorCallback(r.target.value),onKeyDown:r=>r.stopPropagation()})}),t.jsx(d,{field:"category",filter:!0,showFilterMenu:!1,filterPlaceholder:"Kategoriye Göre",sortable:!0,onCellEditComplete:e=>x(e),editor:e=>t.jsx(O,{options:y,onChange:r=>e.editorCallback(r.value.name),placeholder:"Kategori Seçiniz",optionLabel:"name",value:y.find(r=>r.name===e.value)}),header:"Kategori",filterElement:e=>t.jsx(O,{options:y,onChange:r=>e.filterApplyCallback(r.value.name),placeholder:"Kategori Seçiniz",optionLabel:"name",value:y.find(r=>r.name===e.value)})}),t.jsx(d,{field:"calculated_price",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Hesaplanmış Fiyatına Göre",sortable:!0,header:"Ürün Hesaplanmış Fiyatı"}),t.jsx(d,{field:"source",sortable:!0,header:"Ürün Eklenme Tipi"}),t.jsx(d,{field:"price",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Fiyatına Göre",editor:e=>t.jsx(ne,{placeholder:"Ürün Fiyatı",mode:"currency",disabled:g,onChange:r=>e.editorCallback(r.value),value:e.value,currency:"TRY"}),sortable:!0,header:"Ürün Fiyatı",body:({price:e,is_tl:r})=>t.jsxs("span",{className:"p-tag text-md p-tag-success",children:[e," ","₺"]}),onCellEditComplete:e=>{x(e)}}),t.jsx(d,{header:"İşlemler",body:e=>t.jsxs("div",{className:"flex justify-center gap-x-2",children:[t.jsx(h,{icon:"pi pi-images",size:"small",tooltip:"Resimleri Görüntüle",tooltipOptions:{position:"top"},severity:"help",onClick:()=>{S(e),k(!0)}}),t.jsx(h,{icon:"pi pi-pencil",size:"small",tooltip:"Ürünü Düzenle",tooltipOptions:{position:"top"},severity:"info",onClick:()=>{S(e),F(!0)}}),t.jsx(h,{icon:"pi pi-trash",size:"small",tooltip:"Ürünü Sil",tooltipOptions:{position:"top"},severity:"danger",onClick:r=>Z({target:r.currentTarget,message:"Ürünü silmek istediğinize emin misiniz?",icon:"pi pi-exclamation-triangle",acceptClassName:"p-button-danger",acceptLabel:"Sil",rejectLabel:"Vazgeç",accept:()=>{u(!0),fetch(route("products.destroy",e.id),{method:"DELETE",headers:{"X-CSRF-TOKEN":o}}).then(s=>s.json()).then(s=>{s.status?(a.current.show({severity:"success",summary:"Başarılı",detail:s.message}),m(s.products)):a.current.show({severity:"error",summary:"Hata",detail:s.message})}).catch(s=>{a.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{u(!1)})}})})]})})]})})})}),t.jsx(ie,{csrf_token:o,visible:B,products:f.map(({id:e,order:r,name:s,sku:i})=>({id:e,order:r,name:(i+" - "+s).substring(0,70)})),setVisible:F,toast:a,categories:w,onChange:e=>{m(e)},product:j}),t.jsx(ae,{csrf_token:o,visible:D,products:f.map(({id:e,order:r,name:s,sku:i})=>({id:e,order:r,name:(i+" - "+s).substring(0,70)})),setVisible:E,toast:a,categories:w,onChange:e=>{m(e)}}),t.jsx(re,{csrf_token:o,toast:a,visible:M,categoriesAll:y,setVisible:P,onChange:e=>V(e)}),t.jsx(te,{product:j,visible:L,setVisible:k,toast:a,csrf_token:o}),t.jsx(oe,{csrf_token:o,visible:H,setVisible:K,auth:C}),t.jsxs(se,{visible:I,style:{width:"50vw"},footer:t.jsxs(t.Fragment,{children:[t.jsx(h,{label:"Kapat",icon:"pi pi-times",size:"small",loading:g,severity:"secondary",onClick:()=>b(!1)}),t.jsx(h,{label:"Eşitlemeyi Başlat",icon:"pi pi-sync",onClick:()=>{u(!0),fetch(route("products.syncCkymotoservice"),{method:"POST",headers:{"X-CSRF-TOKEN":o},body:JSON.stringify({includePrice:Y,onlyPrice:N,onlyCalculatedPrice:T})}).then(e=>e.json()).then(e=>{e.status?(a.current.show({severity:"success",summary:"Başarılı",detail:e.message}),R(o).then(r=>{r.status?m(r.data):a.current.show({severity:"error",summary:"Hata",detail:"Ürünler yüklenirken bir hata oluştu."})}).catch(r=>{console.log(r),a.current.show({severity:"error",summary:"Hata",detail:"Ürünler yüklenirken bir hata oluştu."})}).finally(()=>u(!1))):a.current.show({severity:"error",summary:"Hata",detail:e.message})}).catch(e=>{a.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{u(!1)})},size:"small",loading:g,className:"p-button-success"})]}),onHide:()=>b(!1),header:"Ürün Eşitlemesi",children:[t.jsxs("div",{className:"flex items-center mt-3",children:[t.jsx(v,{inputId:"ingredient12",name:"pizza",value:"Cheese",onChange:e=>{U(e.target.checked)},checked:N}),t.jsx("label",{htmlFor:"ingredient12",className:"ml-2",children:"Sadece Satış Fiyatlarını Dahil Et(Yeni Ürünler Eklenir,Mevcut ürünlere ait aktiflik deaktiflik durumları değişmez)"})]}),t.jsxs("div",{className:"flex items-center mt-3",children:[t.jsx(v,{inputId:"ingredient122",name:"pizza",value:"Cheese",onChange:e=>{G(e.target.checked)},checked:T}),t.jsx("label",{htmlFor:"ingredient122",className:"ml-2",children:"Sadece Hesaplanan CKYDEN HESAPLANAN Fiyatları Dahil Et(Yeni Ürünler Eklenir,Mevcut ürünlere ait aktiflik deaktiflik durumları değişmez)"})]}),t.jsxs("div",{className:"flex items-center mt-3",children:[t.jsx(v,{inputId:"ingredient123",name:"pizza",value:"Cheese",onChange:e=>{X(e.target.checked)},checked:_}),t.jsx("label",{htmlFor:"ingredient123",className:"ml-2",children:"Sadece Mevcut Ürünler Dahil Et(Yeni Ürünler eklenmez)"})]}),t.jsx(le,{}),t.jsxs("p",{className:"text-semibold",children:["Eşitleme Kaynağı ",t.jsx("b",{className:"text-red-500",children:"CKYMOTOSERVICE.COM"}),t.jsx("br",{}),"İKİSİ KAPALI OLDUĞUNDA STOK GÜNCELLER. ",t.jsx("br",{}),"Birincisi Açıkken Satış fiyatları değişir ",t.jsx("br",{}),"hem birinci hem ikinci açıkken sadece hesaplanan fiyat değişir."]})]})]})})};export{Be as default};
