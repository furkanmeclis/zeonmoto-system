import{r as j,j as e}from"./app-BkMiysKE.js";import{D as b}from"./dialog.esm-DIbkx5_d.js";import{I as d}from"./inputtext.esm-B-_xjB64.js";import{u as w}from"./formik.esm-DororHcK.js";import{D as g}from"./dropdown.esm-D0mmLiW5.js";import{B as u}from"./button.esm-tPdTyaqG.js";import{T as N}from"./tag.esm-BPM_PS8E.js";import"./tooltip.esm-D98gGTBH.js";import"./index.esm-BPFc6-I0.js";import"./index.esm-Ds1AQ0um.js";import"./overlayservice.esm-DFBgVv3U.js";import"./index.esm-D_QygwOb.js";const Y=({auth:t,csrf_token:p,visible:h,setVisible:o,roles:f,onChange:x=()=>{},toast:r})=>{const[i,c]=j.useState(!1),{values:s,handleChange:m,setFieldValue:y}=w({initialValues:{name:"",email:"",password:"",selectedRole:null}}),v=()=>{var n;if(s.name.length===0){r.current.show({severity:"error",summary:"Hata",detail:"Ad Zorunludur"});return}if(s.email.length===0){r.current.show({severity:"error",summary:"Hata",detail:"Email Adresi Zorunludur!"});return}if(s.selectedRole===null){r.current.show({severity:"error",summary:"Hata",detail:"Rol Seçimi Zorunludur!"});return}if(s.password.length===0){r.current.show({severity:"error",summary:"Hata",detail:"Şifre Zorunludur!"});return}c(!0);let a=new FormData;a.append("name",s.name),a.append("password",s.password),a.append("role",(n=s==null?void 0:s.selectedRole)==null?void 0:n.role),a.append("email",s.email),fetch(route("users.store"),{method:"POST",headers:{"X-CSRF-TOKEN":p},body:a}).then(l=>l.json()).then(l=>{l.status?(r.current.show({severity:"success",summary:"Başarılı",detail:l.message}),x(l.users),o(!1)):r.current.show({severity:"error",summary:"Hata",detail:l.message})}).catch(l=>{r.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{c(!1)})};return e.jsx(e.Fragment,{children:e.jsx(b,{header:"Yeni Kullanıcı Ekle",maximizable:!0,visible:h,style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"},onHide:()=>o(!1),footer:e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Kapat",icon:"pi pi-times",size:"small",loading:i,severity:"secondary",onClick:()=>o(!1)}),e.jsx(u,{label:"Kaydet",icon:"pi pi-save",size:"small",loading:i,className:"p-button-success",onClick:v})]}),children:e.jsxs("div",{className:"p-fluid",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:["Adı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(d,{disabled:i,id:"name",type:"text",name:"name",onChange:m,value:s.name})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Mail Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(d,{disabled:i,id:"email",type:"email",name:"email",onChange:m,value:s.email})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"password",className:"font-bold",children:["Şifresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(d,{disabled:i,autoComplete:"false",id:"password",type:"password",name:"password",onChange:m,autoSave:"false",value:s.password})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("label",{htmlFor:"roles",className:"font-bold",children:["Rolü ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"}),e.jsx(g,{disabled:i,inputId:"roles",options:f,optionLabel:"label",placeholder:"Rol Seçiniz",value:s.selectedRole,showClear:!1,onChange:a=>{if((t.user.role==="admin"||t.user.role==="salesman"||t.user.role==="worker")&&a.value.role==="engineer"){r.current.show({severity:"info",summary:"Hata",detail:"Yetkiniz Yok!"});return}y("selectedRole",a.value)},valueTemplate:(a,n)=>a?e.jsx(N,{value:a==null?void 0:a.label,severity:a==null?void 0:a.severity}):e.jsx("span",{children:n.placeholder})}),s.selectedRole!==null&&e.jsx("small",{className:"font-medium",children:s.selectedRole.description})]})})]})})})};export{Y as default};
